# ================================
# Flavor Studios .env.example
# (Copy and rename as `.env.local` for development)
# ================================

# Run `pnpm env:check` to review missing values without failing and
# `pnpm env:check --strict` before building or deploying.

# Load order: scripts/validate-env.ts reads .env.production (when NODE_ENV=production or CI),
# then .env, and finally .env.local. Later files override earlier values.
# Set USE_DEFAULT_ENV=1 to enable safe generated fallbacks (pnpm e2e:build does this automatically).
# Rotate secrets with: `node -e "console.log(require('crypto').randomBytes(32).toString('hex'))"`
# Never commit `.env.local` or real secrets to source control.

# Disable SWC minification due to upstream minifier bug
NEXT_DISABLE_MINIFY=true

# Opt-in flag to allow fallback defaults when running locally without secrets.
# Never set this in CI or production.
# ALLOW_INSECURE_ENV=0

# --- Site Base URL ---
# These values must be the fully-qualified URL for your deployment.
# BASE_URL and NEXTAUTH_URL should match and include the protocol.
# Example: use "http://localhost:3000" for local dev or "https://flavorstudios.in" in production.
NEXT_PUBLIC_BASE_URL=https://flavorstudios.in
BASE_URL=https://flavorstudios.in
NEXTAUTH_URL=https://flavorstudios.in

# Secret token for cron endpoints
# Secret used by cron endpoints (rotate periodically; must stay in sync across workers)
CRON_SECRET=test-secret

# Scheduler timeout (ms) and retry attempts for cron POST requests
# Defaults: 10000ms timeout and 2 attempts
CRON_TIMEOUT_MS=10000
CRON_MAX_ATTEMPTS=2
# Days to retain Firestore cronLog entries
CRON_LOG_RETENTION_DAYS=30

# --- Cron backups ---
# Writable directory for `POST /api/internal/backup` artifacts
BACKUP_DIR=./backups
# Absolute path to service account JSON used for privileged Firestore/Storage export
GOOGLE_APPLICATION_CREDENTIALS=/path/to/firebase-service-account.json
# Number of historical backup snapshots to keep (defaults to 5 when unset)
BACKUP_RETENTION=5

# Domain used when issuing admin-session cookies (leave blank for local dev)
ADMIN_COOKIE_DOMAIN=.flavorstudios.in

# --- Admin Emails (REQUIRED for secure Google login/admin access) ---
# Choose ONE of the following variables:
# - ADMIN_EMAILS: comma-separated list of all authorized admin addresses (no spaces)
Example: "balgatha77@gmail.com"
# - ADMIN_EMAIL: single authorized address
Example: "balgatha77@gmail.com"
# Set the value below accordingly and comment or remove the unused option.
ADMIN_EMAILS=
# ADMIN_EMAIL=

# Optional: Allow all users at a domain (use ONLY if absolutely required)
# ADMIN_DOMAIN=flavorstudios.in

# Require verified email before accessing the admin console ("true" to enforce)
ADMIN_REQUIRE_EMAIL_VERIFICATION=false

# Comma separated list of disposable email domains to block during signup
ADMIN_DISPOSABLE_DOMAINS=

# --- Admin Session ---
# Cookie expiry (days)
ADMIN_SESSION_EXPIRY_DAYS=1

# --- Google Tag Manager (used by GTM snippet in layout) ---
# Provide your GTM container ID (e.g., GTM-XXXXXXX). Leave blank to disable.
NEXT_PUBLIC_GTM_CONTAINER_ID=GTM-XXXXXXX
# Allow banner on non-production environments (useful for local/staging tests).
# Set to "true" to enable; keep "false" in production unless needed.
NEXT_PUBLIC_ENABLE_GTM_COOKIE_BANNER=false

# --- CookieYes (Cookie Consent Manager) ---
# Provide your CookieYes ID (e.g., abcdef1234567890). Leave blank to disable.
NEXT_PUBLIC_COOKIEYES_ID=abcdef1234567890

# --- Bing Search API Key (optional, for SEO indexing features) ---
BING_API_KEY=your_bing_api_key_here

# --- IndexNow API Key (optional, for instant indexing) ---
INDEXNOW_KEY=your_indexnow_key_here

# --- Sitemap URL used for SEO audit scripts ---
# Defaults to the production sitemap if unset.
SITEMAP_URL=https://flavorstudios.in/sitemap.xml

# --- Firebase Web App (Client-side config) ---
NEXT_PUBLIC_FIREBASE_API_KEY=your_firebase_api_key_here
NEXT_PUBLIC_FIREBASE_AUTH_DOMAIN=your_firebase_auth_domain_here
NEXT_PUBLIC_FIREBASE_PROJECT_ID=your_firebase_project_id_here

# IMPORTANT: Storage bucket must be set on BOTH client and server and MUST MATCH exactly.
# CI will fail if these are missing or differ. Example format: my-firebase-project.appspot.com
NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET=your_firebase_storage_bucket_here

NEXT_PUBLIC_FIREBASE_MESSAGING_SENDER_ID=your_firebase_messaging_sender_id_here
NEXT_PUBLIC_FIREBASE_APP_ID=your_firebase_app_id_here
NEXT_PUBLIC_FIREBASE_VAPID_KEY=your_firebase_vapid_key_here

# --- Web Push (VAPID) for Notifications ---
# If set, Web Push will be enabled for in-browser notifications.
# Generate with: npx web-push generate-vapid-keys
VAPID_PRIVATE_KEY=
# Use a contact email or URL as the subject (RFC8292).
VAPID_SUBJECT=mailto:admin@flavorstudios.in

# --- Firebase Admin SDK (Server-only, JSON string) ---
# Provide the service account JSON as a single-line string.
# Set **one** of the following variables:
# - FIREBASE_SERVICE_ACCOUNT_KEY (recommended)
# - FIREBASE_SERVICE_ACCOUNT_JSON (alias)
# - FIREBASE_SERVICE_ACCOUNT_JSON_B64 (base64 encoded JSON)
FIREBASE_SERVICE_ACCOUNT_KEY={"type":"service_account","project_id":"your_id","private_key_id":"your_id","private_key":"-----BEGIN PRIVATE KEY-----\\nMIIEv...\\n-----END PRIVATE KEY-----\\n","client_email":"your_email","client_id":"your_id", ... }
# Optional alias if your server code expects this name.
# Copy the JSON from FIREBASE_SERVICE_ACCOUNT_KEY if you use this variable instead.
FIREBASE_SERVICE_ACCOUNT_JSON=
# Base64 encoded form of the same JSON (useful for Vercel dashboard input restrictions).
FIREBASE_SERVICE_ACCOUNT_JSON_B64=

# IMPORTANT: Must match NEXT_PUBLIC_FIREBASE_STORAGE_BUCKET exactly (CI enforced).
# Example format: my-firebase-project.appspot.com
FIREBASE_STORAGE_BUCKET=your_firebase_storage_bucket_here

# --- Perspective Comment Analyzer API Key ---
PERSPECTIVE_API_KEY=your_perspective_api_key_here

# --- Database URL (if using Prisma/SQL) ---
DATABASE_URL=your_database_url_here

# --- Admin Authentication/Authorization ---
# Enable to expose the legacy env-based admin login toggle to the UI.
# Leave "false" in production. When "true", ADMIN_BYPASS must also be "true".
NEXT_PUBLIC_ENABLE_LEGACY_ADMIN_LOGIN=false
# Hard-disable all admin checks (including Firestore). Use ONLY for local E2E.
ADMIN_BYPASS=false
# Bcrypt hash of admin password (never store plain text passwords!)
ADMIN_PASSWORD_HASH=your_bcrypt_hash_here

# Shared secret for JWT admin session cookies
# Shared secret for JWT admin session cookies (rotate with the command above)
ADMIN_JWT_SECRET=your_jwt_secret_here

# Secret used to sign preview tokens
# See docs/preview-secret.md for storage/rotation details.
# Secret used to sign preview tokens (rotate whenever an admin loses access)
PREVIEW_SECRET=your_preview_secret_here

# Optional: server-only key for programmatic admin API access
# ADMIN_API_KEY=your_admin_api_key_here

# --- Rate Limiter (Upstash Redis) ---
UPSTASH_REDIS_REST_URL=
UPSTASH_REDIS_REST_TOKEN=

# Optional: TOTP (2FA) secret for admin login
# ADMIN_TOTP_SECRET=your_totp_secret_here

# Mirror of ADMIN_REQUIRE_EMAIL_VERIFICATION for client side UI prompts
NEXT_PUBLIC_REQUIRE_ADMIN_EMAIL_VERIFICATION=false

# --- Contact Inbox & Email Replies ---
# All addresses allowed as the "From" sender (for replies in admin dashboard)
CONTACT_REPLY_EMAILS=admin@flavorstudios.in,studio@flavorstudios.in,career@flavorstudios.in,contact@flavorstudios.in,newsletter@flavorstudios.in
# Each address above must have matching SMTP_USER_<NAME> and SMTP_PASS_<NAME> vars.
# Example: contact@flavorstudios.in -> SMTP_USER_CONTACT / SMTP_PASS_CONTACT

# --- SMTP configuration for outbound mail (all 5 senders) ---
SMTP_HOST=smtp.zoho.in
SMTP_PORT=587
SMTP_SECURE=false

# Credentials for each authenticated SMTP user (App Password required for each)
SMTP_USER_ADMIN=admin@flavorstudios.in
SMTP_PASS_ADMIN=your_app_password_for_admin

SMTP_USER_STUDIO=studio@flavorstudios.in
SMTP_PASS_STUDIO=your_app_password_for_studio

SMTP_USER_CAREER=career@flavorstudios.in
SMTP_PASS_CAREER=your_app_password_for_career

SMTP_USER_CONTACT=contact@flavorstudios.in
SMTP_PASS_CONTACT=your_app_password_for_contact

SMTP_USER_NEWSLETTER=newsletter@flavorstudios.in
SMTP_PASS_NEWSLETTER=your_app_password_for_newsletter

# Flag to email admins when a new contact or career submission arrives
NOTIFY_NEW_SUBMISSION=true

# --- Test / automation toggles ---
# Enable deterministic fixtures and auth bypass when running integration tests.
# Leave these disabled in production builds.
TEST_MODE=false
NEXT_PUBLIC_E2E=0

# --- Debug/Admin Logging ---
DEBUG_ADMIN=true

# --- Additional Recommendations ---
# - Do NOT commit `.env.local` or any file containing real secrets.
# - Rotate keys if they ever leak.
# - Use Vercel or your hostâ€™s dashboard to manage production secrets.
# - Keep sensitive values out of client-side code (e.g., only expose NEXT_PUBLIC_ vars if absolutely needed).

# --- Sample: Properly Escaped FIREBASE_SERVICE_ACCOUNT_KEY ---
# {
#   "type": "service_account",
#   "project_id": "your_project_id",
#   "private_key_id": "xxxx",
#   "private_key": "-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----\\n",
#   "client_email": "firebase-adminsdk@your_project_id.iam.gserviceaccount.com",
#   "client_id": "123456789",
#   ...
# }
